<!-- BotÃ³n flotante de chatbot IA -->
<button
  id="chatbotBtn"
  class="chatbot-btn fixed bottom-6 right-6 flex items-center bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-full shadow-lg overflow-hidden group transition-all duration-300 ease-in-out hover:shadow-2xl cursor-pointer border-0 z-50"
>
  <!-- Ãcono de IA con animaciÃ³n de pulso -->
  <div class="w-6 h-6 ml-4 flex-shrink-0 relative">
    <svg 
      xmlns="http://www.w3.org/2000/svg" 
      viewBox="0 0 24 24" 
      fill="none" 
      stroke="currentColor" 
      stroke-width="2" 
      stroke-linecap="round" 
      stroke-linejoin="round"
      class="w-6 h-6 animate-pulse"
    >
      <path d="M12 2a3 3 0 0 0-3 3v1a3 3 0 0 0-3 3v1a3 3 0 0 0-3 3v3a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-3a3 3 0 0 0-3-3V9a3 3 0 0 0-3-3V5a3 3 0 0 0-3-3z"/>
      <circle cx="9" cy="10" r="1"/>
      <circle cx="15" cy="10" r="1"/>
      <path d="M9 15c.5.5 1.5 1 3 1s2.5-.5 3-1"/>
    </svg>
  </div>
  
  <!-- Texto expandible -->
  <span
    class="ml-2 mr-4 text-sm font-medium whitespace-nowrap opacity-0 w-0 group-hover:w-auto group-hover:opacity-100 transition-all duration-500 ease-in-out"
  >
    Chatea con nuestro asistente IA
  </span>
</button>

<!-- Modal del chatbot (oculto por defecto) -->
<div id="chatbotModal" class="fixed bottom-24 right-6 w-96 h-[500px] bg-white rounded-2xl shadow-2xl hidden flex-col overflow-hidden z-50">
  <!-- Header del chat -->
  <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-4 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
        <svg 
          xmlns="http://www.w3.org/2000/svg" 
          viewBox="0 0 24 24" 
          fill="none" 
          stroke="currentColor" 
          stroke-width="2"
          class="w-6 h-6"
        >
          <path d="M12 2a3 3 0 0 0-3 3v1a3 3 0 0 0-3 3v1a3 3 0 0 0-3 3v3a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-3a3 3 0 0 0-3-3V9a3 3 0 0 0-3-3V5a3 3 0 0 0-3-3z"/>
        </svg>
      </div>
      <div>
        <h3 class="font-semibold">Asistente IA</h3>
        <p class="text-xs opacity-90">En lÃ­nea</p>
      </div>
    </div>
    <button id="closeChatBtn" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
      </svg>
    </button>
  </div>
  
  <!-- Ãrea de mensajes -->
  <div id="chatMessages" class="flex-1 p-4 overflow-y-auto bg-gray-50">
    <div class="flex items-start gap-2 mb-4">
      <div class="w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex-shrink-0 flex items-center justify-center text-white text-xs">
        IA
      </div>
      <div class="bg-white rounded-lg p-3 shadow-sm max-w-[80%]">
        <p class="text-sm text-gray-800">Â¡Hola! ğŸ‘‹ Soy tu asistente virtual. Â¿En quÃ© puedo ayudarte hoy?</p>
      </div>
    </div>
  </div>
  
  <!-- Input de mensaje -->
  <div class="p-4 bg-white border-t border-gray-200">
    <div class="flex gap-2">
      <input
        type="text"
        id="messageInput"
        placeholder="Escribe tu mensaje..."
        class="flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:border-purple-500 text-sm"
      />
      <button
        id="sendBtn"
        class="bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-full p-2 hover:opacity-90 transition-opacity flex-shrink-0"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
          <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
        </svg>
      </button>
    </div>
  </div>
</div>

<script>
  // Funcionalidad del chatbot
  const chatbotBtn = document.getElementById('chatbotBtn');
  const chatbotModal = document.getElementById('chatbotModal');
  const closeChatBtn = document.getElementById('closeChatBtn');
  const sendBtn = document.getElementById('sendBtn');
  const messageInput = document.getElementById('messageInput') as HTMLInputElement;
  const chatMessages = document.getElementById('chatMessages');

  // Abrir chatbot
  chatbotBtn?.addEventListener('click', () => {
    chatbotModal?.classList.remove('hidden');
    chatbotModal?.classList.add('flex');
  });

  // Cerrar chatbot
  closeChatBtn?.addEventListener('click', () => {
    chatbotModal?.classList.add('hidden');
    chatbotModal?.classList.remove('flex');
  });

  // Enviar mensaje
  function sendMessage() {
    const message = messageInput?.value.trim();
    if (!message) return;

    // AÃ±adir mensaje del usuario
    const userMessageDiv = document.createElement('div');
    userMessageDiv.className = 'flex items-start gap-2 mb-4 justify-end';
    userMessageDiv.innerHTML = `
      <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg p-3 shadow-sm max-w-[80%]">
        <p class="text-sm">${message}</p>
      </div>
      <div class="w-8 h-8 bg-gray-300 rounded-full flex-shrink-0 flex items-center justify-center text-gray-600 text-xs">
        TÃš
      </div>
    `;
    chatMessages?.appendChild(userMessageDiv);

    // Limpiar input
    if (messageInput) messageInput.value = '';

    // Scroll al final
    if (chatMessages) {
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Simular respuesta de la IA (aquÃ­ puedes integrar tu API)
    setTimeout(() => {
      const aiMessageDiv = document.createElement('div');
      aiMessageDiv.className = 'flex items-start gap-2 mb-4';
      aiMessageDiv.innerHTML = `
        <div class="w-8 h-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex-shrink-0 flex items-center justify-center text-white text-xs">
          IA
        </div>
        <div class="bg-white rounded-lg p-3 shadow-sm max-w-[80%]">
          <p class="text-sm text-gray-800">Gracias por tu mensaje. Estoy aquÃ­ para ayudarte. ğŸ˜Š</p>
        </div>
      `;
      chatMessages?.appendChild(aiMessageDiv);
      
      // Scroll al final
      if (chatMessages) {
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
    }, 1000);
  }

  // Click en botÃ³n enviar
  sendBtn?.addEventListener('click', sendMessage);

  // Enter para enviar
  messageInput?.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      sendMessage();
    }
  });
</script>

<style>
  /* AnimaciÃ³n personalizada para el pulso */
  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: .5;
    }
  }

  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  /* Scrollbar personalizado */
  #chatMessages::-webkit-scrollbar {
    width: 6px;
  }

  #chatMessages::-webkit-scrollbar-track {
    background: #f1f1f1;
  }

  #chatMessages::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 3px;
  }

  #chatMessages::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
</style>
