---
import { Wrench, Car, Paintbrush, Battery, Gauge, Bolt, Clock, CheckCircle2 } from "lucide-astro";

// 6 servicios a modo de ejemplo
const servicios = [
  {
    icon: Wrench,
    img: "/mantenimiento.png",
    titulo: "Mantenimiento Preventivo",
    descripcion: "Programa completo de mantenimiento para mantener tu vehículo en óptimas condiciones.",
    caracteristicas: ["Cambio de aceite", "Revisión de frenos", "Diagnóstico completo"],
    tiempo: "2-3 horas"
  },
  {
    icon: Car,
    img: "/reparaciones.png",
    titulo: "Reparaciones Mecánicas",
    descripcion: "Expertos en solucionar problemas de motor, suspensión y transmisión con garantía.",
    caracteristicas: ["Motor y transmisión", "Sistema de suspensión", "Garantía incluida"],
    tiempo: "4-8 horas"
  },
  {
    icon: Paintbrush,
    img: "/pintura.png",
    titulo: "Pintura y Detallado",
    descripcion: "Restauración completa de pintura con acabado profesional y protección duradera.",
    caracteristicas: ["Pintura profesional", "Pulido y encerado", "Detallado interior"],
    tiempo: "2-5 días"
  },
  {
    icon: Battery,
    img: "/bateria.png",
    titulo: "Cambio de Batería",
    descripcion: "Instalación rápida de baterías de alta calidad con revisión del sistema eléctrico.",
    caracteristicas: ["Baterías premium", "Prueba del alternador", "Instalación incluida"],
    tiempo: "30 min"
  },
  {
    icon: Gauge,
    img: "/diagnostico.png",
    titulo: "Diagnóstico Computarizado",
    descripcion: "Escaneo avanzado de todos los sistemas del vehículo con reporte detallado.",
    caracteristicas: ["Escaneo completo OBD", "Reporte detallado", "Lectura de códigos"],
    tiempo: "1 hora"
  },
  {
    icon: Bolt,
    img: "/electricidad.png",
    titulo: "Sistema Eléctrico",
    descripcion: "Reparación especializada de sistemas eléctricos, sensores y componentes electrónicos.",
    caracteristicas: ["Diagnóstico eléctrico", "Reparación de sensores", "Sistema de luces"],
    tiempo: "2-4 horas"
  },
];

// dividir en grupos de 3
const slides = [];
for (let i = 0; i < servicios.length; i += 3) {
  slides.push(servicios.slice(i, i + 3));
}
---

<section class="w-full py-24 bg-gradient-to-br from-blue-50 via-white to-blue-50">
  <div class="max-w-7xl mx-auto px-6 relative">

    <!-- Título de sección -->
    <div class="text-center mb-16">
      <h2 class="text-4xl font-bold text-gray-900 mb-4">Nuestros Servicios</h2>
      <p class="text-gray-600 text-lg">Soluciones profesionales para mantener tu vehículo en perfecto estado</p>
    </div>

    <!-- Carrusel contenedor -->
    <div id="carousel" class="overflow-hidden relative">
      <div id="slider" class="flex transition-transform duration-700 ease-out">
        {slides.map((slide) => (
          <div class="min-w-full grid grid-cols-1 md:grid-cols-3 gap-8 px-4">

            {slide.map(({ icon: Icon, img, titulo, descripcion, caracteristicas, tiempo }) => (
              <div class="bg-white rounded-2xl overflow-hidden group relative h-[480px] cursor-pointer shadow-lg hover:shadow-2xl transition-all duration-500 border border-blue-100">
                
                {/* Contenido por defecto */}
                <div class="absolute inset-0 flex flex-col p-8 group-hover:opacity-0 transition-opacity duration-500">
                  
                  {/* Header con icono */}
                  <div class="flex items-center justify-between mb-6">
                    <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-lg">
                      <Icon class="w-8 h-8 text-white" />
                    </div>
                    <div class="flex items-center gap-2 text-sm text-gray-500">
                      <Clock class="w-4 h-4" />
                      <span>{tiempo}</span>
                    </div>
                  </div>

                  {/* Título y descripción */}
                  <h3 class="text-2xl font-bold text-gray-900 mb-4">
                    {titulo}
                  </h3>
                  
                  <p class="text-gray-600 mb-6 leading-relaxed">
                    {descripcion}
                  </p>

                  {/* Lista de características */}
                  <div class="space-y-3 mt-auto">
                    {caracteristicas.map((item) => (
                      <div class="flex items-start gap-3">
                        <CheckCircle2 class="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" />
                        <span class="text-sm text-gray-700">{item}</span>
                      </div>
                    ))}
                  </div>

                  {/* Badge inferior */}
                  <div class="mt-6 pt-6 border-t border-gray-100">
                    <span class="inline-block px-4 py-2 bg-blue-50 text-blue-700 rounded-full text-sm font-medium">
                      Cotizar servicio →
                    </span>
                  </div>
                </div>

                {/* Imagen + info detallada al hover */}
                <div class="absolute inset-0 opacity-0 group-hover:opacity-100 transition-all duration-500">
                  <img src={img} alt={titulo}
                    class="w-full h-full object-cover scale-110 group-hover:scale-100 transition-transform duration-700" />
                  
                  {/* Overlay con gradiente */}
                  <div class="absolute inset-0 bg-gradient-to-t from-blue-900/95 via-blue-900/60 to-transparent"></div>
                  
                  {/* Contenido sobre la imagen */}
                  <div class="absolute inset-0 flex flex-col justify-end p-8">
                    
                    {/* Badge de tiempo */}
                    <div class="inline-flex items-center gap-2 px-4 py-2 bg-white/20 backdrop-blur-sm rounded-full text-white text-sm mb-4 self-start">
                      <Clock class="w-4 h-4" />
                      <span>Tiempo estimado: {tiempo}</span>
                    </div>

                    <h3 class="text-3xl font-bold text-white mb-4 transform translate-y-2 group-hover:translate-y-0 transition-transform duration-500">
                      {titulo}
                    </h3>
                    
                    <p class="text-white/95 leading-relaxed mb-6 transform translate-y-4 group-hover:translate-y-0 transition-transform duration-500 delay-75">
                      {descripcion}
                    </p>

                    {/* Lista de características en hover */}
                    <div class="space-y-2 mb-6 transform translate-y-6 group-hover:translate-y-0 transition-transform duration-500 delay-100">
                      {caracteristicas.map((item) => (
                        <div class="flex items-center gap-3">
                          <div class="w-1.5 h-1.5 bg-blue-300 rounded-full"></div>
                          <span class="text-sm text-white/90">{item}</span>
                        </div>
                      ))}
                    </div>

                    {/* CTA Button */}
                    <button class="w-full bg-white text-blue-600 font-semibold py-3 px-6 rounded-xl hover:bg-blue-50 transition-colors duration-300 transform translate-y-8 group-hover:translate-y-0 duration-500 delay-150">
                      Solicitar este servicio
                    </button>
                  </div>
                </div>

              </div>
            ))}

          </div>
        ))}
      </div>
    </div>

    <!-- Flechas con diseño mejorado -->
    <button id="prev"
      class="absolute top-1/2 -left-6 -translate-y-1/2 w-14 h-14 bg-white rounded-full shadow-xl hover:shadow-2xl flex items-center justify-center text-blue-600 hover:bg-blue-50 transition-all duration-300 hover:scale-110 border border-blue-100">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>

    <button id="next"
      class="absolute top-1/2 -right-6 -translate-y-1/2 w-14 h-14 bg-white rounded-full shadow-xl hover:shadow-2xl flex items-center justify-center text-blue-600 hover:bg-blue-50 transition-all duration-300 hover:scale-110 border border-blue-100">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 5l7 7-7 7"/>
      </svg>
    </button>

    <!-- Indicadores mejorados -->
    <div class="flex justify-center mt-14 gap-2">
      {slides.map(() => (
        <button class="dot h-2 rounded-full bg-blue-200 hover:bg-blue-400 transition-all duration-300"></button>
      ))}
    </div>

  </div>
</section>

<script is:inline>
document.addEventListener("DOMContentLoaded", function() {
  const slider = document.getElementById("slider");
  const dots = document.querySelectorAll(".dot");
  const carousel = document.getElementById("carousel");

  if (!slider || dots.length === 0) return;

  let index = 0;
  const total = dots.length;
  let autoplayInterval;
  let isInteracting = false;

  function updateCarousel() {
    slider.style.transform = "translateX(-" + (index * 100) + "%)";
    dots.forEach(function(d, i) {
      if (i === index) {
        d.classList.remove("w-2", "bg-blue-200");
        d.classList.add("w-12", "bg-blue-600");
      } else {
        d.classList.remove("w-12", "bg-blue-600");
        d.classList.add("w-2", "bg-blue-200");
      }
    });
  }

  function startAutoplay() {
    if (autoplayInterval) clearInterval(autoplayInterval);
    autoplayInterval = setInterval(function() {
      if (!isInteracting) {
        index = (index + 1) % total;
        updateCarousel();
      }
    }, 6000);
  }

  function stopAutoplay() {
    if (autoplayInterval) {
      clearInterval(autoplayInterval);
      autoplayInterval = null;
    }
  }

  carousel.addEventListener("mouseenter", function() {
    isInteracting = true;
  });

  carousel.addEventListener("mouseleave", function() {
    isInteracting = false;
  });

  document.getElementById("next").onclick = function() {
    index = (index + 1) % total;
    updateCarousel();
    stopAutoplay();
    setTimeout(startAutoplay, 1000);
  };

  document.getElementById("prev").onclick = function() {
    index = (index - 1 + total) % total;
    updateCarousel();
    stopAutoplay();
    setTimeout(startAutoplay, 1000);
  };

  dots.forEach(function(dot, i) {
    dot.addEventListener("click", function() {
      index = i;
      updateCarousel();
      stopAutoplay();
      setTimeout(startAutoplay, 1000);
    });
  });

  updateCarousel();
  startAutoplay();
});
</script>